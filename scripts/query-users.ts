import { PrismaClient } from "@prisma/client";
import * as dotenv from "dotenv";

dotenv.config();

const prisma = new PrismaClient();

async function main() {
  try {
    // ç²å–ç¸½ç”¨æˆ¶æ•¸
    const totalUsers = await prisma.user.count();

    // ç²å–æœ€æ–°çš„20å€‹ç”¨æˆ¶
    const users = await prisma.user.findMany({
      take: 20,
      orderBy: {
        createdAt: "desc",
      },
    });

    console.log("\nğŸ“Š ç”¨æˆ¶çµ±è¨ˆè³‡è¨Š");
    console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
    console.log(`ç¸½ç”¨æˆ¶æ•¸: ${totalUsers}`);
    console.log(`é¡¯ç¤ºæœ€æ–°ç”¨æˆ¶æ•¸: ${users.length}`);
    console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n");

    if (users.length === 0) {
      console.log("ç›®å‰æ²’æœ‰ç”¨æˆ¶è³‡æ–™\n");
      return;
    }

    // è¡¨æ ¼åŒ–é¡¯ç¤º
    console.log("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    console.log("â”‚ User ID                          â”‚ Name        â”‚ Email                    â”‚ Google ID              â”‚ Created At        â”‚");
    console.log("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");

    users.forEach((user) => {
      const userId = (user.userId || "").padEnd(32);
      const name = (user.name || "N/A").padEnd(12);
      const email = (user.email || "N/A").padEnd(24);
      const googleId = (user.googleId || "N/A").padEnd(22);
      const createdAt = user.createdAt.toISOString().split("T")[0].padEnd(18);

      console.log(
        `â”‚ ${userId} â”‚ ${name} â”‚ ${email} â”‚ ${googleId} â”‚ ${createdAt} â”‚`
      );
    });

    console.log("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");
  } catch (error) {
    console.error("âŒ æŸ¥è©¢å¤±æ•—:", error);
    process.exit(1);
  } finally {
    await prisma.$disconnect();
  }
}

main();

