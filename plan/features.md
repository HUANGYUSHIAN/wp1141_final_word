# 功能開發清單

本文檔整理當前系統已開發的功能，每項功能包含技術實現與內容描述。

---

## 🔐 認證系統

### Google OAuth 登入
使用 NextAuth.js 整合 Google OAuth 2.0，支援 PKCE 安全流程，自動建立用戶帳號並儲存 Google ID 與基本資訊。

### 測試登入
提供 Credentials Provider 測試登入功能，使用 User ID 直接登入，方便開發與測試環境使用。

### 角色選擇系統
新用戶首次登入時導向角色選擇頁面，可選擇 Student 或 Supplier，系統根據選擇初始化對應資料結構。

### Session 管理
使用 JWT 策略管理用戶會話，有效期 30 天，包含 userId、角色資訊與基本用戶資料。

### 路由保護 Middleware
實作 Next.js Middleware 進行路由保護，根據用戶角色與登入狀態自動重定向，確保權限控制。

---

## 👨‍🎓 學生功能

### 單字本管理
支援建立、編輯、刪除單字本，包含名稱、語言設定、公開選項，使用 Prisma 進行資料持久化。

### 單字本瀏覽
提供公開單字本瀏覽功能，支援名稱、語言篩選，可加入個人單字本列表，顯示作者名稱而非 ID。

### 單字本建立（手動）
手動建立單字本功能，透過 LLM API 搜尋單字，驗證格式後建立，最多 30 個單字，支援多語言。

### AI 生成單字本
整合 OpenAI API 自動生成單字本，根據主題、程度、語言生成 30 個單字，非同步處理並顯示生成進度。

### 單字本上傳（Excel）
使用 papaparse 解析 Excel 檔案，自動讀取標題列並匯入單字資料，支援批量建立單字本。

### 單字管理（CRUD）
單字列表分頁顯示，支援編輯、刪除、批量更新，即時儲存至資料庫，包含完整格式驗證。

### 文法家教
整合 OpenAI GPT-4o-mini 提供文法教學，支援英文/日文，可詢問或推薦主題，包含 Quick Replies 快速回應。

### 單字遊戲
提供 Wordle 猜謎遊戲與貪食蛇遊戲，使用單字本內容作為題目，遊戲結果可獲得點數獎勵。

### 單字複習
顯示學生單字本列表，支援篩選與瀏覽，可選擇單字本進行複習，顯示單字詳細資訊。

### 單字測驗
提供單字測驗功能，從學生單字本中選擇題目，支援多種測驗模式，記錄測驗結果。

### 點數兌換
顯示可用優惠券列表，使用點數進行抽獎，實作中獎率機制，抽中後加入我的優惠券列表。

### 我的優惠券
顯示已獲得的優惠券列表，包含優惠券詳細資訊、使用期限、QR Code 或連結，支援過期提醒。

### 意見回饋
提供意見回饋表單，可提交對系統的建議或問題，回饋內容儲存至資料庫供管理員查看。

### 個人設定
基本設定頁面架構，未來將擴展個人資料編輯、付款資訊管理、隱私設定等功能。

---

## 🏪 供應商功能

### 優惠券管理
完整的優惠券 CRUD 功能，包含名稱、期限、連結、內容、圖片設計，可查看擁有者列表。

### 店鋪管理
管理店鋪資訊功能，包含店名、地址、網站、營業時間，可查看使用者評分與評論列表。

### 回饋查看
查看使用者對店鋪的回饋意見，包含評分與評論內容，協助改善服務品質。

### 供應商設定
基本設定頁面架構，未來將擴展供應商資料編輯、付款資訊管理、通知設定等功能。

---

## 👨‍💼 管理員功能

### 用戶管理
完整的用戶 CRUD 功能，可查看、編輯、刪除、新增用戶，支援帳號上鎖與角色升級，顯示 LLM 配額。

### 單字本管理
管理所有單字本資料，支援查看、編輯、刪除、新增，可查看單字內容並進行編輯，分頁顯示。

### 優惠券管理
管理所有優惠券資料，支援查看、編輯、刪除、新增，可設定公開狀態，分頁顯示大量資料。

### 單字本上傳
支援 Excel 檔案上傳，自動解析並建立單字本，包含完整格式驗證與錯誤處理。

### 回饋管理
查看所有使用者提交的意見回饋，可進行回覆或處理，協助改善系統功能。

### 管理員設定
系統設定頁面，可調整網頁參數與系統配置，未來將擴展更多管理功能。

---

## 🤖 AI 功能

### AI 助手
整合於側邊欄的 AI 助手功能，提供對話式介面，可回答問題與提供協助，使用 OpenAI API。

### LLM 配額追蹤
追蹤每位用戶的 LLM 使用配額，計算 API 成本並更新配額，防止超額使用，顯示於管理介面。

### 單字搜尋 API
使用 LLM 驗證與搜尋單字，根據語言與格式要求返回完整單字資料，包含格式驗證。

---

## 🎨 UI/UX 功能

### Material-UI 整合
使用 Material-UI 組件庫建立現代化介面，包含響應式設計、主題系統、動畫效果。

### 響應式設計
支援桌面與行動裝置，使用 ResponsiveWrapper 自動調整佈局，適應不同螢幕尺寸。

### 側邊欄導航
可收合的側邊欄導航系統，包含功能選單、AI 助手按鈕，支援快速切換頁面。

### 分頁顯示
大量資料使用分頁顯示，避免一次性載入造成效能問題，支援自訂每頁筆數。

### 錯誤處理
完整的錯誤處理機制，包含 API 錯誤、資料驗證錯誤、網路錯誤的友善提示。

### 載入狀態
使用 CircularProgress 顯示載入狀態，提升用戶體驗，避免操作等待時的困惑。

---

## 🔒 安全性功能

### 權限檢查
所有 API 路由進行權限檢查，確保用戶只能存取有權限的資料，防止未授權存取。

### 資料驗證
完整的資料驗證機制，包含必填欄位、格式檢查、長度限制，確保資料完整性。

### 作者名稱顯示
單字本作者顯示名稱而非 User ID，提升安全性，避免暴露敏感資訊。

### Session 驗證
所有受保護路由進行 Session 驗證，確保用戶已登入且具有正確角色權限。

---

## 🔧 系統功能

### 環境變數管理
使用 dotenv 管理環境變數，支援本地與生產環境切換，敏感資訊不提交至版本控制。

### 錯誤追蹤
完整的錯誤追蹤機制，記錄資料庫連接、API 呼叫、查詢效能等資訊，協助除錯。

### 連接池管理
Prisma 連接池管理，包含連接測試、超時設定、錯誤重試，確保資料庫連接穩定。

### 非同步處理
AI 生成單字本使用非同步處理，不阻塞用戶操作，顯示生成進度與狀態。

---

## 📝 備註

- 所有功能均使用 TypeScript 確保型別安全
- API 路由使用 Next.js App Router 架構
- 資料庫操作使用 Prisma ORM 進行抽象化
- UI 組件使用 Material-UI 確保一致性
- 所有功能均包含完整的錯誤處理與使用者回饋

