# Final Project – Midterm Plan

## Deploy Link
https://word-war-app.vercel.app/

## 1. 本次 Prototype 已完成
- 認證系統：Google OAuth 登入、角色選擇（Student/Supplier）、Session 管理、Middleware 路由保護
- 資料庫架構：Prisma Schema 定義、MongoDB 整合、完整的資料模型（User, Student, Supplier, Admin, Vocabulary, Word, Coupon, Store）
- Admin 功能：用戶管理（查看、編輯、刪除、新增、上鎖、升級權限）、單字本管理（CSV 檔案、Excel 匯入）、優惠券管理（CRUD）、分頁顯示
- Student 功能：單字本瀏覽與加入、單字本建立與管理、單字管理（CRUD、批量更新）、優惠券瀏覽與抽獎（含中獎率機制）、我的優惠券查看、遊戲功能（Wordle 猜謎遊戲、貪食蛇遊戲）、點數系統（可用來抽取優惠券）、單字複習頁面、使用者反饋頁面
- Supplier 功能：優惠券管理（建立、編輯、刪除、查看、擁有者列表）、店鋪管理（店名、地址、營業時間、網站）、回饋查看
- UI/UX 基礎：Material-UI 整合、響應式設計、語言選擇組件、基本錯誤處理

## 2. 最終版本預計完成項目
- 完整的使用者流程優化
- 資料驗證與錯誤處理強化
- 安全性強化（API 請求頻率限制、XSS 防護、權限檢查）
- Student 功能完善：個人資料編輯、付款資訊管理、複習功能完善、單字本統計分析
- Supplier 功能完善：優惠券使用統計、店鋪評論管理、店鋪評分統計
- Admin 功能完善：用戶搜尋與篩選、單字本審核功能、優惠券審核功能、系統設定
- 三大主要功能：單字學習系統、優惠券抽獎系統、遊戲點數系統

## 3. 預期開發進度
- Week 1: 完成資料驗證與錯誤處理、安全性強化、Student 個人資料編輯功能
- Week 2: 完成 Supplier 優惠券統計功能、Admin 搜尋與篩選功能、單字本審核功能
- Week 3: 介面調整與最終整合、系統測試、部署優化

---

# 全端背單字 & 抽獎券服務 - 開發計劃與進度

## 📋 專案概述

本專案是一個全端背單字與抽獎券服務平台，提供三種角色完整的服務：
- **Student（學生）**：背單字、獲得優惠券
- **Supplier（優惠券供應者）**：管理優惠券、店鋪資訊
- **Admin（管理員）**：管理用戶、單字本、優惠券

## 🎯 開發階段

### 第一階段：核心功能開發（現階段）
**目標**：建立完整的 CRUD 功能與基本流程，不考慮遊戲、點數計算、用戶體驗優化

### 第二階段：優化與擴展（未來）
**目標**：遊戲功能、點數計算邏輯、用戶體驗優化、進階功能

---

## ✅ 已完成功能

### 1. 認證系統
- [x] Google OAuth 登入
- [x] 測試登入（Credentials）
- [x] 角色選擇（Student/Supplier）
- [x] Session 管理
- [x] Middleware 路由保護
- [x] 新用戶導向角色選擇頁面

### 2. 資料庫架構
- [x] Prisma Schema 定義
- [x] User, Student, Supplier, Admin 資料模型
- [x] Vocabulary, Word 資料模型
- [x] Coupon 資料模型
- [x] Store, Comment 資料模型
- [x] MongoDB 整合

### 3. Admin 功能
- [x] 用戶管理（查看、編輯、刪除、新增、上鎖）
- [x] 單字本管理（查看、編輯、刪除、新增）
- [x] 優惠券管理（查看、編輯、刪除、新增）
- [x] 單字本上傳（Excel 匯入）
- [x] 分頁顯示（大量資料分批載入）
- [x] 管理員設定腳本

### 4. Student 功能
- [x] 單字本瀏覽與加入
- [x] 單字本建立
- [x] 單字本管理（查看、編輯、刪除）
- [x] 單字管理（查看、編輯、刪除、批量更新）
- [x] 優惠券瀏覽
- [x] 優惠券抽獎（已實作 API，但點數計算邏輯待優化）
- [x] 我的優惠券查看
- [x] 設定頁面（基本架構）
- [x] 遊戲頁面（猜謎遊戲、貪食蛇遊戲）
- [x] 複習頁面（基本架構）
- [x] 回饋功能

### 5. Supplier 功能
- [x] 優惠券管理（建立、編輯、刪除、查看）
- [x] 優惠券擁有者查看
- [x] 店鋪管理（建立、編輯、刪除、查看）
- [x] 設定頁面（基本架構）
- [x] 回饋查看

### 6. UI/UX 基礎
- [x] Material UI 整合
- [x] 響應式設計（ResponsiveWrapper）
- [x] 語言選擇組件
- [x] 導航系統
- [x] 基本錯誤處理

---

## 🚧 待開發功能（第一階段）

### 1. Student 功能完善
- [ ] **單字本功能**
  - [ ] 單字本分享功能
  - [ ] 單字本搜尋與篩選
  - [ ] 單字本匯出功能
  - [ ] 單字本統計（學習進度、掌握度等）

- [ ] **優惠券功能**
  - [ ] 優惠券使用記錄
  - [ ] 優惠券過期提醒
  - [ ] 優惠券詳細資訊顯示

- [ ] **設定功能**
  - [ ] 個人資料編輯（電話、生日、語言等）
  - [ ] 付款資訊管理（信用卡等）
  - [ ] 隱私設定

- [ ] **複習功能**
  - [ ] 單字複習列表
  - [ ] 複習進度追蹤
  - [ ] 複習提醒

### 2. Supplier 功能完善
- [ ] **優惠券功能**
  - [ ] 優惠券使用統計
  - [ ] 優惠券效果分析
  - [ ] 優惠券批量管理

- [ ] **店鋪功能**
  - [ ] 店鋪評論管理
  - [ ] 店鋪評分統計
  - [ ] 店鋪資訊完整編輯

- [ ] **設定功能**
  - [ ] 供應商資料編輯
  - [ ] 付款資訊管理
  - [ ] 通知設定

### 3. Admin 功能完善
- [ ] **用戶管理**
  - [ ] 用戶搜尋與篩選
  - [ ] 用戶批量操作
  - [ ] 用戶活動記錄

- [ ] **單字本管理**
  - [ ] 單字本審核功能
  - [ ] 單字本統計分析
  - [ ] 單字本批量操作

- [ ] **優惠券管理**
  - [ ] 優惠券審核功能
  - [ ] 優惠券使用統計
  - [ ] 優惠券批量操作

- [ ] **系統設定**
  - [ ] 系統參數設定
  - [ ] 系統日誌查看
  - [ ] 資料備份與還原

### 4. 資料驗證與錯誤處理
- [ ] 完整的表單驗證
- [ ] 錯誤訊息優化
- [ ] 資料完整性檢查
- [ ] API 錯誤處理統一化

### 5. 安全性強化
- [ ] API 請求頻率限制
- [ ] 資料輸入清理（XSS 防護）
- [ ] 權限檢查強化
- [ ] 敏感資料加密

---

## 🔮 未來優化目標（第二階段）

### 1. 遊戲功能優化與點數系統
**目標**：優化當前遊戲的玩家體驗以及點數計算方式

**執行規劃**：
- **遊戲體驗優化**
  - 優化遊戲介面設計，提升視覺效果與操作流暢度
  - 實作遊戲難度分級系統，根據使用者程度自動調整
  - 加入遊戲音效與視覺回饋，提升遊戲沉浸感
  - 優化遊戲載入速度與效能表現
  - 實作遊戲暫停、重試、提示等功能

- **點數計算系統**
  - 設計完整的點數計算邏輯（答對率、連續答對、難度係數等）
  - 實作點數獲取規則（不同遊戲類型、難度給予不同點數）
  - 建立點數使用規則（抽獎券消耗、特殊功能解鎖等）
  - 開發點數歷史記錄功能，追蹤點數獲取與使用歷程
  - 設計點數轉換機制（不同遊戲點數可互相轉換）

**技術實作**：
- 建立點數計算 Service，統一管理點數邏輯
- 設計點數交易記錄資料表
- 實作即時點數更新機制
- 建立點數統計與分析 Dashboard

### 2. LLM 創建單字本功能
**目標**：根據使用者提供的使用地點、場合與程度，提供單字與符合情況的例句

**執行規劃**：
- **LLM 整合**
  - 選擇合適的 LLM API（OpenAI GPT、Claude、或本地模型）
  - 設計 Prompt 模板，包含地點、場合、程度等參數
  - 實作單字生成邏輯，確保單字符合使用者需求
  - 生成符合情境的例句，提升學習效果

- **功能開發**
  - 建立單字本生成頁面，收集使用者需求（地點、場合、程度）
  - 實作 LLM API 呼叫與回應處理
  - 設計單字本預覽功能，讓使用者確認後再建立
  - 實作單字本自動儲存與管理功能
  - 加入單字本編輯功能，允許使用者調整生成內容

**技術實作**：
- 建立 LLM Service，封裝 API 呼叫邏輯
- 設計 Prompt Engineering 策略，優化生成品質
- 實作錯誤處理與重試機制
- 建立單字本生成記錄，追蹤使用情況

### 3. 廠商管理系統優化與 Google Maps 整合
**目標**：提供多樣化與客製化的優惠券與商鋪資訊設計，並整合 Google Maps API，協助使用者找到店鋪

**執行規劃**：
- **優惠券與商鋪設計優化**
  - 開發優惠券模板系統，提供多樣化設計選項
  - 實作客製化優惠券編輯器（圖片、文字、樣式等）
  - 建立商鋪資訊完整編輯功能（營業時間、聯絡方式、特色介紹等）
  - 實作優惠券與商鋪資訊預覽功能

- **Google Maps 整合**
  - 申請 Google Maps API Key 並設定環境變數
  - 整合 Google Maps JavaScript API，顯示店鋪位置
  - 實作位置儲存功能，將店鋪座標存入資料庫
  - 開發「開始前往」功能，自動開啟 Google Maps 並載入位置
  - 實作路線規劃模式，協助使用者導航至店鋪

**技術實作**：
- 建立 Google Maps Service，封裝地圖相關功能
- 設計 Store 資料表擴充，加入座標、地址等欄位
- 實作前端地圖組件，整合 Google Maps
- 開發深層連結（Deep Link）功能，開啟 Google Maps App
- 建立位置驗證機制，確保座標正確性

### 4. 建立 4 種背單字遊戲
**目標**：擴展遊戲類型，提供更多元的學習方式

**執行規劃**：
- **遊戲類型設計**
  1. **記憶配對遊戲**：單字與解釋配對，訓練記憶力
  2. **填空遊戲**：提供例句，填入正確單字
  3. **聽力遊戲**：播放單字發音，選擇正確答案
  4. **拼字競速遊戲**：限時內拼出最多單字

- **功能開發**
  - 設計統一的遊戲介面架構，便於新增遊戲類型
  - 實作遊戲選擇頁面，讓使用者選擇想玩的遊戲
  - 建立遊戲結果統計，追蹤各遊戲表現
  - 實作遊戲進度儲存，支援中斷後繼續
  - 設計遊戲難度調整機制

**技術實作**：
- 建立遊戲組件架構，統一遊戲介面與邏輯
- 設計遊戲資料結構，支援不同遊戲類型
- 實作遊戲狀態管理，追蹤遊戲進度
- 建立遊戲結果 API，儲存遊戲記錄

### 5. 使用者行為追蹤工具 — PostHog 整合
**目標**：追蹤用戶行為，理解自身優缺點，用於優化用戶體驗

**執行規劃**：
- **PostHog 設定**
  - 申請 PostHog 帳號並建立專案
  - 取得 PostHog API Key 並設定環境變數
  - 安裝 PostHog JavaScript SDK
  - 設定事件追蹤規則與儀表板

- **追蹤功能開發**
  - 追蹤使用者登入與使用頻率
  - 追蹤遊戲表現與學習進度
  - 追蹤單字本使用情況
  - 追蹤優惠券抽獎與使用行為
  - 追蹤頁面瀏覽路徑與停留時間
  - 追蹤錯誤與異常事件

- **分析與優化**
  - 建立使用者行為分析儀表板
  - 識別使用者痛點與流失原因
  - 分析功能使用率，優化產品設計
  - 建立 A/B 測試機制，驗證優化效果

**技術實作**：
- 整合 PostHog SDK 到 Next.js 應用
- 設計事件追蹤規範，統一事件命名
- 實作隱私保護機制，符合 GDPR 規範
- 建立追蹤資料分析流程，定期檢視數據

---

## 📊 開發進度總覽

### 整體進度：約 60%

#### 已完成模組
- ✅ 認證系統：100%
- ✅ 資料庫架構：100%
- ✅ Admin 核心功能：90%
- ✅ Student 核心功能：70%
- ✅ Supplier 核心功能：70%
- ✅ UI/UX 基礎：60%

#### 進行中
- 🚧 Student 設定功能完善
- 🚧 Supplier 店鋪功能完善
- 🚧 資料驗證與錯誤處理

#### 待開始
- ⏳ 點數系統設計
- ⏳ 遊戲功能優化
- ⏳ 社交功能開發

---

## 🎯 第一階段開發重點

### 優先級 1（核心功能）
1. Student 設定功能完善
2. Supplier 設定功能完善
3. 資料驗證與錯誤處理
4. 安全性強化

### 優先級 2（功能擴展）
1. Student 複習功能完善
2. Supplier 店鋪評論管理
3. Admin 系統設定
4. 統計與分析功能

### 優先級 3（優化）
1. 搜尋與篩選功能
2. 批量操作功能
3. 匯出功能
4. 通知系統基礎

---

## 📝 技術規格

### 前端
- **框架**：Next.js 16 (App Router)
- **UI 框架**：Material UI
- **語言**：TypeScript
- **狀態管理**：React Hooks
- **響應式設計**：自定義 ResponsiveWrapper

### 後端
- **框架**：Next.js API Routes
- **資料庫**：MongoDB
- **ORM**：Prisma
- **認證**：NextAuth.js
- **環境變數**：dotenv

### 部署
- **平台**：Vercel
- **資料庫**：MongoDB Atlas（或本地 MongoDB）

---

## 🔄 開發流程

1. **需求分析**：根據 plan/plan.md 定義功能需求
2. **API 設計**：設計 RESTful API 端點
3. **資料庫設計**：更新 Prisma Schema
4. **後端開發**：實作 API Routes
5. **前端開發**：實作頁面與組件
6. **測試**：功能測試與錯誤修正
7. **部署**：部署到 Vercel

---

## 📌 注意事項

### 現階段不考慮
- ❌ 遊戲功能優化（已實作基本功能，優化留待第二階段）
- ❌ 點數計算邏輯（API 已實作，邏輯優化留待第二階段）
- ❌ 用戶體驗優化（動畫、過渡效果等）
- ❌ 進階統計與分析
- ❌ 社交功能

### 開發原則
1. **功能優先**：先完成核心功能，再考慮優化
2. **資料完整性**：確保資料庫操作的正確性
3. **安全性**：基本的權限檢查與資料驗證
4. **可擴展性**：程式碼結構要便於未來擴展

---

## 📅 更新記錄

- **2024-12-01**：建立開發計劃文檔
  - 列出已完成功能
  - 定義待開發功能
  - 設定開發優先級

---

## 🔗 相關文檔

- [資料結構與規格](./plan/plan.md)
- [OAuth 錯誤處理](./plan/oauth_error.md)
- [OAuth 規格說明](./plan/oauth_spec.md)

